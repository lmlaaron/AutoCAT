#flush + reload defend    blocks = 8, associativity = 2
# here we assume detector knows the secret victim's data so he will lock them in the cache
2 DD 00001111
00000000 W
00000001 W
00000002 W
00000003 W
00000004 W
00000005 W
00000006 W
00000007 W
#the cache is fully populated. now the attacker will flush a cache line. but it will not be flushed since the line is locked
00000002 F 
00000006 F 
#the next three instructions are done by the victim. he is just accessing his sensitive data.
00000007 R
00000003 R
00000006 R
#now the attacker read data from cache line 6 to see if it was accessed by the victim or not.
#however, it will always be a hit and the attacker cannot infer if it was accessed by the victim or not
00000002 R 
00000006 R
#next round of flushes
00000007 F 
00000003 F 
#victim access
00000002 R
#realod phase
00000003 R 
00000007 R
#if we lock those lines that the attacker wants to flush, the attacker always get het hit on reload phase and attack fails