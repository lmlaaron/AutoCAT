[2023-06-14 05:19:59,553][root][INFO] - {"env_config": {"length_violation_reward": -2.0, "double_victim_access_reward": -0.01, "victim_access_reward": -0.01, "correct_reward": 1.0, "wrong_reward": -1.0, "step_reward": -0.01, "verbose": 1, "force_victim_hit": false, "flush_inst": true, "allow_victim_multi_access": true, "allow_empty_victim_access": false, "attacker_addr_s": 0, "attacker_addr_e": 1, "victim_addr_s": 0, "victim_addr_e": 1, "reset_limit": 1, "cache_configs": {"architecture": {"word_size": 1, "block_size": 1, "write_back": true}, "cache_1": {"blocks": 2, "associativity": 1, "hit_time": 1, "rep_policy": "lru"}, "mem": {"hit_time": 1000}}, "window_size": 64}, "model_config": {"type": "transformer", "args": {"latency_dim": 3, "victim_acc_dim": 2, "action_dim": 64, "step_dim": 64, "action_embed_dim": 16, "step_embed_dim": 4, "hidden_dim": 128, "output_dim": -1, "num_layers": 1}}, "m_server_name": "m_server", "m_server_addr": "127.0.0.1:4411", "r_server_name": "r_server", "r_server_addr": "127.0.0.1:4412", "c_server_name": "c_server", "c_server_addr": "127.0.0.1:4413", "train_device": "cuda:0", "infer_device": "cuda:0", "num_train_rollouts": 1, "num_train_workers": 1, "num_eval_rollouts": 1, "num_eval_workers": 1, "replay_buffer_size": 1024, "prefetch": 2, "batch_size": 512, "optimizer": {"name": "Adam", "lr": 0.0001}, "learning_starts": 65536, "model_push_period": 10, "entropy_coeff": 0.02, "num_epochs": 1000, "steps_per_epoch": 3000, "num_eval_episodes": 100, "seed": null, "table_view": false}
[2023-06-14 05:23:40,391][root][INFO] - {"return": {"mean": -0.062335661106975665, "std": 0.20892293850302987, "min": -0.858400285243988, "max": 0.2355835735797882, "count": 3000, "key": "return"}, "policy_ratio": {"mean": 1.000542969087758, "std": 0.010185289106120616, "min": 0.9614189863204956, "max": 1.0367587804794312, "count": 3000, "key": "policy_ratio"}, "policy_loss": {"mean": -0.06402396595353885, "std": 0.0215571052225516, "min": -0.10150554031133652, "max": -7.450580596923828e-09, "count": 3000, "key": "policy_loss"}, "value_loss": {"mean": 0.7525938373605425, "std": 0.09746418379785982, "min": 0.5688048601150513, "max": 1.1104704141616821, "count": 3000, "key": "value_loss"}, "entropy": {"mean": 1.55201450121403, "std": 0.14810537184986128, "min": 1.3008780479431152, "max": 1.9035139083862305, "count": 3000, "key": "entropy"}, "loss": {"mean": 0.281232663005591, "std": 0.06304018017722238, "min": 0.1801309585571289, "max": 0.48424896597862244, "count": 3000, "key": "loss"}, "grad_norm": {"mean": 2.108242566893496, "std": 1.0362540025876514, "min": 0.4046260416507721, "max": 9.315221786499023, "count": 3000, "key": "grad_norm"}, "sample_data_time/ms": {"mean": 0.1703192073315829, "std": 1.2508134237668203, "min": 0.0464550003016484, "max": 50.875687999905495, "count": 3000, "key": "sample_data_time/ms"}, "batch_learn_time/ms": {"mean": 65.40043262199066, "std": 100.82579069262675, "min": 52.43031600002723, "max": 5573.419170000307, "count": 3000, "key": "batch_learn_time/ms"}, "episode_length": {"mean": 5.406703615729747, "std": 4.00159211281721, "min": 1.0, "max": 34.0, "count": 3789, "key": "episode_length"}, "episode_return": {"mean": -0.20901819941675986, "std": 0.9809304630731879, "min": -1.3300000429153442, "max": 0.9900000095367432, "count": 3789, "key": "episode_return"}, "episode_time/s": {"mean": 0.052641410297153954, "std": 0.09965394955154037, "min": 0.0030847510788589716, "max": 5.648188591003418, "count": 3789, "key": "episode_time/s"}, "steps_per_second": {"mean": 124.78345857279477, "std": 57.5216570011062, "min": 1.7704792022705078, "max": 486.7628479003906, "count": 3789, "key": "steps_per_second"}, "correct_rate": {"mean": 0.41752441277381885, "std": 0.49315086688730053, "min": 0.0, "max": 1.0, "count": 3789, "key": "correct_rate"}, "info": "T Epoch 0", "phase": "Train", "epoch": 0, "time": 217.98193559599986}
[2023-06-14 05:23:45,406][root][INFO] - {"episode_length": {"mean": 5.159999999999999, "std": 1.12, "min": 5.0, "max": 13.0, "count": 100, "key": "episode_length"}, "episode_return": {"mean": 0.21840000092983247, "std": 0.9644466729357656, "min": -1.0399999618530273, "max": 0.9599999785423279, "count": 100, "key": "episode_return"}, "episode_time/s": {"mean": 0.020176803348585962, "std": 0.005242848962993297, "min": 0.010077333077788353, "max": 0.047238290309906006, "count": 100, "key": "episode_time/s"}, "steps_per_second": {"mean": 264.8286390686035, "std": 54.36556335310608, "min": 163.5693817138672, "max": 496.16302490234375, "count": 100, "key": "steps_per_second"}, "correct_rate": {"mean": 0.6300000000000001, "std": 0.4828043081829324, "min": 0.0, "max": 1.0, "count": 100, "key": "correct_rate"}, "info": "E Epoch 0", "phase": "Eval", "epoch": 0, "time": 222.997288949}
[2023-06-14 05:27:04,322][root][INFO] - {"return": {"mean": 0.011603060852658583, "std": 0.056249841296223284, "min": -0.1902458369731903, "max": 0.18004965782165527, "count": 3000, "key": "return"}, "policy_ratio": {"mean": 0.9998126381834338, "std": 0.01294954857020575, "min": 0.9477812051773071, "max": 1.0408248901367188, "count": 3000, "key": "policy_ratio"}, "policy_loss": {"mean": -0.0749023132501171, "std": 0.009265876650276802, "min": -0.09761212766170502, "max": -0.0005349870771169662, "count": 3000, "key": "policy_loss"}, "value_loss": {"mean": 0.7106984262267758, "std": 0.043314052020686306, "min": 0.5879228115081787, "max": 0.8565536737442017, "count": 3000, "key": "value_loss"}, "entropy": {"mean": 1.2594132324854523, "std": 0.07488296642462478, "min": 1.0666130781173706, "max": 1.4090180397033691, "count": 3000, "key": "entropy"}, "loss": {"mean": 0.2552586358835292, "std": 0.026410729877272807, "min": 0.17704619467258453, "max": 0.40073031187057495, "count": 3000, "key": "loss"}, "grad_norm": {"mean": 1.9130416795611402, "std": 0.5693099774122309, "min": 0.9182460904121399, "max": 6.595211029052734, "count": 3000, "key": "grad_norm"}, "sample_data_time/ms": {"mean": 0.12729031699291243, "std": 0.699966408883729, "min": 0.04667200028052321, "max": 23.219522000545112, "count": 3000, "key": "sample_data_time/ms"}, "batch_learn_time/ms": {"mean": 65.19282749533153, "std": 7.047849191373298, "min": 54.71677900004579, "max": 101.28726899984031, "count": 3000, "key": "batch_learn_time/ms"}, "episode_length": {"mean": 6.5521528198908445, "std": 3.8417581173303526, "min": 1.0, "max": 31.0, "count": 3298, "key": "episode_length"}, "episode_return": {"mean": -0.05794722918960965, "std": 1.0001303362813645, "min": -1.2999999523162842, "max": 0.9900000095367432, "count": 3298, "key": "episode_return"}, "episode_time/s": {"mean": 0.0605508525154948, "std": 0.03977018594498728, "min": 0.006086532026529312, "max": 0.30668723583221436, "count": 3298, "key": "episode_time/s"}, "steps_per_second": {"mean": 122.98505075430435, "std": 57.5861903028636, "min": 32.992313385009766, "max": 451.0152893066406, "count": 3298, "key": "steps_per_second"}, "correct_rate": {"mean": 0.4987871437234703, "std": 0.49999852897748914, "min": 0.0, "max": 1.0, "count": 3298, "key": "correct_rate"}, "info": "T Epoch 1", "phase": "Train", "epoch": 1, "time": 421.9133232389995}
[2023-06-14 05:27:09,330][root][INFO] - {"episode_length": {"mean": 5.0, "std": 0.0, "min": 5.0, "max": 5.0, "count": 100, "key": "episode_length"}, "episode_return": {"mean": -0.11999998927116393, "std": 0.9967948338433671, "min": -1.0399999618530273, "max": 0.9599999785423279, "count": 100, "key": "episode_return"}, "episode_time/s": {"mean": 0.020175846340134737, "std": 0.0017981094349975835, "min": 0.014541108161211014, "max": 0.027142535895109177, "count": 100, "key": "episode_time/s"}, "steps_per_second": {"mean": 249.82653472900392, "std": 22.935305986386883, "min": 184.21270751953125, "max": 343.8527526855469, "count": 100, "key": "steps_per_second"}, "correct_rate": {"mean": 0.46, "std": 0.4983974317750846, "min": 0.0, "max": 1.0, "count": 100, "key": "correct_rate"}, "info": "E Epoch 1", "phase": "Eval", "epoch": 1, "time": 426.9216671889999}
[2023-06-14 05:30:28,188][root][INFO] - {"return": {"mean": 0.6226393989676927, "std": 0.35616350369408595, "min": -0.13544917106628418, "max": 0.9881455898284912, "count": 3000, "key": "return"}, "policy_ratio": {"mean": 0.9968235267798096, "std": 0.013522159501964968, "min": 0.9310414791107178, "max": 1.0455056428909302, "count": 3000, "key": "policy_ratio"}, "policy_loss": {"mean": -0.04432026515404383, "std": 0.01698114244921504, "min": -0.08856751024723053, "max": -0.0021422477439045906, "count": 3000, "key": "policy_loss"}, "value_loss": {"mean": 0.33031341618020044, "std": 0.2716956020857142, "min": 0.01529014389961958, "max": 0.8473219275474548, "count": 3000, "key": "value_loss"}, "entropy": {"mean": 0.5653811917205639, "std": 0.3642715984145323, "min": 0.15756112337112427, "max": 1.1710293292999268, "count": 3000, "key": "entropy"}, "loss": {"mean": 0.10952881928440185, "std": 0.11583420874888378, "min": -0.017823705449700356, "max": 0.3977094888687134, "count": 3000, "key": "loss"}, "grad_norm": {"mean": 0.9995165816148096, "std": 0.5358138533551127, "min": 0.1438044309616089, "max": 3.265875816345215, "count": 3000, "key": "grad_norm"}, "sample_data_time/ms": {"mean": 0.1250265636720841, "std": 0.6892999717060123, "min": 0.047745000301802065, "max": 22.06508000017493, "count": 3000, "key": "sample_data_time/ms"}, "batch_learn_time/ms": {"mean": 65.16023823465424, "std": 6.9733938884459725, "min": 54.45520600005693, "max": 97.57724100018095, "count": 3000, "key": "batch_learn_time/ms"}, "episode_length": {"mean": 5.617283950617293, "std": 1.9651135642024855, "min": 1.0, "max": 22.0, "count": 3807, "key": "episode_length"}, "episode_return": {"mean": 0.580830041993345, "std": 0.7810675605086238, "min": -1.2100000381469727, "max": 0.9900000095367432, "count": 3807, "key": "episode_return"}, "episode_time/s": {"mean": 0.052351889156719185, "std": 0.02285034545916753, "min": 0.005130906123667955, "max": 0.22411443293094635, "count": 3807, "key": "episode_time/s"}, "steps_per_second": {"mean": 122.0280283408619, "std": 61.87748094475415, "min": 31.88944435119629, "max": 467.4654541015625, "count": 3807, "key": "steps_per_second"}, "correct_rate": {"mean": 0.8135014447071186, "std": 0.389508464820149, "min": 0.0, "max": 1.0, "count": 3807, "key": "correct_rate"}, "info": "T Epoch 2", "phase": "Train", "epoch": 2, "time": 625.7796015719996}
[2023-06-14 05:30:33,199][root][INFO] - {"episode_length": {"mean": 5.0, "std": 0.0, "min": 5.0, "max": 5.0, "count": 100, "key": "episode_length"}, "episode_return": {"mean": 0.9599999785423279, "std": 0.0, "min": 0.9599999785423279, "max": 0.9599999785423279, "count": 100, "key": "episode_return"}, "episode_time/s": {"mean": 0.019071750212460752, "std": 0.0038043645985935026, "min": 0.011330398730933666, "max": 0.03067277930676937, "count": 100, "key": "episode_time/s"}, "steps_per_second": {"mean": 272.26621841430665, "std": 52.34159600514322, "min": 163.010986328125, "max": 441.2907409667969, "count": 100, "key": "steps_per_second"}, "correct_rate": {"mean": 1.0, "std": 0.0, "min": 1.0, "max": 1.0, "count": 100, "key": "correct_rate"}, "info": "E Epoch 2", "phase": "Eval", "epoch": 2, "time": 630.7901083639999}
[2023-06-14 05:33:51,663][root][INFO] - {"return": {"mean": 0.9800359728137635, "std": 0.044618880145727444, "min": 0.80922931432724, "max": 1.0570783615112305, "count": 3000, "key": "return"}, "policy_ratio": {"mean": 0.9904092201789236, "std": 0.030166496676788317, "min": 0.873897135257721, "max": 1.348473072052002, "count": 3000, "key": "policy_ratio"}, "policy_loss": {"mean": -0.020029025178557924, "std": 0.010675400862199553, "min": -0.05171119049191475, "max": 0.14353641867637634, "count": 3000, "key": "policy_loss"}, "value_loss": {"mean": 0.06836903943853392, "std": 0.045871252089832545, "min": 0.00017366536485496908, "max": 0.25050443410873413, "count": 3000, "key": "value_loss"}, "entropy": {"mean": 0.1732203072880703, "std": 0.06370978626866101, "min": 0.047995489090681076, "max": 0.3825201392173767, "count": 3000, "key": "entropy"}, "loss": {"mean": 0.01069108848293158, "std": 0.021532791718425225, "min": -0.0559704452753067, "max": 0.15244702994823456, "count": 3000, "key": "loss"}, "grad_norm": {"mean": 0.3616160313996178, "std": 0.36279733240816225, "min": 0.04850391671061516, "max": 7.335916519165039, "count": 3000, "key": "grad_norm"}, "sample_data_time/ms": {"mean": 0.1317128486556, "std": 0.8356522570263659, "min": 0.0473770005555707, "max": 23.500923999563383, "count": 3000, "key": "sample_data_time/ms"}, "batch_learn_time/ms": {"mean": 65.0449294533347, "std": 7.185807613227352, "min": 53.965400000379304, "max": 92.49367399934272, "count": 3000, "key": "batch_learn_time/ms"}, "episode_length": {"mean": 5.239950062421972, "std": 1.344745913003625, "min": 1.0, "max": 50.0, "count": 4005, "key": "episode_length"}, "episode_return": {"mean": 0.9131560362680137, "std": 0.2970848345479214, "min": -1.2000000476837158, "max": 0.9800000190734863, "count": 4005, "key": "episode_return"}, "episode_time/s": {"mean": 0.049606396178465004, "std": 0.01915975895633057, "min": 0.005956909153610468, "max": 0.4639647603034973, "count": 4005, "key": "episode_time/s"}, "steps_per_second": {"mean": 119.85470267592333, "std": 55.36524867033981, "min": 43.891326904296875, "max": 560.1673583984375, "count": 4005, "key": "steps_per_second"}, "correct_rate": {"mean": 0.9777777777777795, "std": 0.14740554623801777, "min": 0.0, "max": 1.0, "count": 4005, "key": "correct_rate"}, "info": "T Epoch 3", "phase": "Train", "epoch": 3, "time": 829.2539436679999}
[2023-06-14 05:33:56,679][root][INFO] - {"episode_length": {"mean": 5.0, "std": 0.0, "min": 5.0, "max": 5.0, "count": 100, "key": "episode_length"}, "episode_return": {"mean": 0.9599999785423279, "std": 0.0, "min": 0.9599999785423279, "max": 0.9599999785423279, "count": 100, "key": "episode_return"}, "episode_time/s": {"mean": 0.018117620833218093, "std": 0.0028524696863357385, "min": 0.013200326822698116, "max": 0.03007594496011734, "count": 100, "key": "episode_time/s"}, "steps_per_second": {"mean": 282.2602258300781, "std": 40.92843394021177, "min": 166.24581909179688, "max": 378.77850341796875, "count": 100, "key": "steps_per_second"}, "correct_rate": {"mean": 1.0, "std": 0.0, "min": 1.0, "max": 1.0, "count": 100, "key": "correct_rate"}, "info": "E Epoch 3", "phase": "Eval", "epoch": 3, "time": 834.2704499559995}
[2023-06-14 05:37:14,149][root][INFO] - {"return": {"mean": 1.0500364182790136, "std": 0.04206051142478928, "min": 0.8822355270385742, "max": 1.1204665899276733, "count": 3000, "key": "return"}, "policy_ratio": {"mean": 0.9858604873021438, "std": 0.02610853867397857, "min": 0.8555313348770142, "max": 1.4952235221862793, "count": 3000, "key": "policy_ratio"}, "policy_loss": {"mean": -0.018189612056439104, "std": 0.007627580061605025, "min": -0.04593413323163986, "max": 0.04095803573727608, "count": 3000, "key": "policy_loss"}, "value_loss": {"mean": 0.07077167631270512, "std": 0.05983547372529155, "min": 0.0003177392645739019, "max": 0.33841168880462646, "count": 3000, "key": "value_loss"}, "entropy": {"mean": 0.25979883041729535, "std": 0.057866223183388354, "min": 0.12285878509283066, "max": 0.39510947465896606, "count": 3000, "key": "entropy"}, "loss": {"mean": 0.01200024958436067, "std": 0.028294759268632945, "min": -0.036869700998067856, "max": 0.14015845954418182, "count": 3000, "key": "loss"}, "grad_norm": {"mean": 0.26185167491311817, "std": 0.2268144883031224, "min": 0.030900347977876663, "max": 4.4775848388671875, "count": 3000, "key": "grad_norm"}, "sample_data_time/ms": {"mean": 0.12835205699957444, "std": 0.7070190105665299, "min": 0.04601499949785648, "max": 19.829238000056648, "count": 3000, "key": "sample_data_time/ms"}, "batch_learn_time/ms": {"mean": 64.64360211834403, "std": 6.875584592409376, "min": 54.763158000241674, "max": 94.15694800009078, "count": 3000, "key": "batch_learn_time/ms"}, "episode_length": {"mean": 5.214734724666828, "std": 0.8014659288990078, "min": 1.0, "max": 20.0, "count": 3977, "key": "episode_length"}, "episode_return": {"mean": 0.9141010627214212, "std": 0.29328903082922686, "min": -1.190000057220459, "max": 0.9700000286102295, "count": 3977, "key": "episode_return"}, "episode_time/s": {"mean": 0.0497902009657475, "std": 0.016259650876577013, "min": 0.006367227993905544, "max": 0.17709362506866455, "count": 3977, "key": "episode_time/s"}, "steps_per_second": {"mean": 117.01405546405606, "std": 48.29070365648381, "min": 27.714223861694336, "max": 447.844970703125, "count": 3977, "key": "steps_per_second"}, "correct_rate": {"mean": 0.9781242142318354, "std": 0.14627794011809234, "min": 0.0, "max": 1.0, "count": 3977, "key": "correct_rate"}, "info": "T Epoch 4", "phase": "Train", "epoch": 4, "time": 1031.7063633519992}
[2023-06-14 05:37:19,178][root][INFO] - {"episode_length": {"mean": 5.0, "std": 0.0, "min": 5.0, "max": 5.0, "count": 100, "key": "episode_length"}, "episode_return": {"mean": 0.9599999785423279, "std": 0.0, "min": 0.9599999785423279, "max": 0.9599999785423279, "count": 100, "key": "episode_return"}, "episode_time/s": {"mean": 0.022379015125334262, "std": 0.002539091677169808, "min": 0.018333174288272858, "max": 0.03062477707862854, "count": 100, "key": "episode_time/s"}, "steps_per_second": {"mean": 226.07545257568358, "std": 23.606938215790798, "min": 163.26649475097656, "max": 272.7296142578125, "count": 100, "key": "steps_per_second"}, "correct_rate": {"mean": 1.0, "std": 0.0, "min": 1.0, "max": 1.0, "count": 100, "key": "correct_rate"}, "info": "E Epoch 4", "phase": "Eval", "epoch": 4, "time": 1036.769314776}
